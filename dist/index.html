<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>FreshBasket</title>
    <link rel="stylesheet" href="/styles.css?v=4" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@700&display=swap" rel="stylesheet" />
  </head>
  <body>
    <main class="content"><div id="react-root"></div></main>
    <script src="/firebase-config.js"></script>
    <script>
      // Ensure a global toast API is available even before React mounts; pending toasts are flushed by the Toaster component.
      window.__pendingToasts = window.__pendingToasts || [];
      if (typeof window.showToast !== 'function') {
        window.showToast = function(message, opts) {
          window.__pendingToasts.push({ message, opts: opts || {} });
          return null;
        };
      }
      if (typeof window.hideToast !== 'function') {
        window.hideToast = function(id) {
          try{ if (window.__pendingToasts) window.__pendingToasts = window.__pendingToasts.filter(t=>t.id!==id); }catch(_){ }
        };
      }
    </script>
    <script type="module" src="/app.js?v=4"></script>
    <script>
      // Intercept same-origin link clicks to trigger client-side navigation (for static build)
      document.addEventListener('click', function(e){
        try{
          const a = e.target.closest && e.target.closest('a');
          if(!a) return;
          const href = a.getAttribute('href');
          if(!href) return;
          // ignore anchors, external links, mailto/tel
          if(href.startsWith('#') || href.startsWith('mailto:') || href.startsWith('tel:')) return;
          const url = new URL(href, window.location.href);
          if(url.origin !== window.location.origin) return;
          // Only handle internal app routes
          if(url.pathname && url.pathname.startsWith('/')){
            e.preventDefault();
            history.pushState({}, '', url.pathname + url.search + url.hash);
            window.dispatchEvent(new PopStateEvent('popstate'));
          }
        }catch(_){ /* noop */ }
      }, true);
    </script>
  </body>
</html>
