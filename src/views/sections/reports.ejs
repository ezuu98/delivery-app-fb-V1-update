<section class="rider-commissions">
  <header class="rc-header">
    <h2 class="rc-title">Reporting & Analytics</h2>
    <p class="rc-subtitle">Gain insights into your delivery operations with detailed reports and visualizations.</p>
  </header>

  <div class="rc-toolbar">
    <div class="rc-filters">
      <button class="rc-select rc-chip" data-tab="overview">Overview</button>
      <button class="rc-select rc-chip" data-tab="performance">Performance</button>
      <button class="rc-select rc-chip" data-tab="custom">Custom Reports</button>
    </div>
  </div>

  <div id="tab-overview">
    <div class="rc-table-wrapper" style="padding:16px;display:grid;grid-template-columns:1fr 1fr;gap:16px;">
      <div class="rc-select rc-chip" style="display:block">
        <div class="section-title" style="margin:0">Total Deliveries</div>
        <div style="font-size:26px;font-weight:700"><%= (metrics && metrics.totalDeliveries) || 0 %></div>
      </div>
      <div class="rc-select rc-chip" style="display:block">
        <div class="section-title" style="margin:0">Average Delivery Time</div>
        <div style="font-size:26px;font-weight:700"><%= (metrics && metrics.avgDeliveryMins) || 0 %> mins</div>
      </div>
    </div>

    <div class="rc-toolbar" style="align-items:center">
      <div class="section-title" style="margin:0">Delivery Data</div>
      <label class="rc-select rc-chip" style="display:inline-flex;align-items:center;gap:8px">
        <input type="checkbox" id="toggleData" /> Show Delivery Data Table
      </label>
    </div>

    <div class="rc-table-wrapper" id="dataTable" style="display:none">
      <table class="rc-table">
        <thead>
          <tr>
            <th class="col-name">Order Number</th>
            <th class="col-km">Rider Assigned</th>
            <th class="col-perf">Expected Time</th>
            <th class="col-perf">Actual Delivery Time</th>
            <th class="col-perf">Distance Traveled</th>
            <th class="col-comm">Status</th>
          </tr>
        </thead>
        <tbody>
          <% (orders||[]).forEach(o=>{ %>
            <tr>
              <td class="rc-col-name">#<%= o.name || o.order_number || o.id %></td>
              <td class="rc-col-km">-</td>
              <td class="rc-col-perf">-</td>
              <td class="rc-col-perf">-</td>
              <td class="rc-col-perf">-</td>
              <td class="rc-col-commission"><%= (o.fulfillment_status||'new') %></td>
            </tr>
          <% }) %>
          <% if(!orders || orders.length===0){ %>
            <tr><td colspan="6" class="section-note">No data.</td></tr>
          <% } %>
        </tbody>
      </table>
    </div>
  </div>
</section>

<script>
  (function(){
    const toggle = document.getElementById('toggleData');
    const table = document.getElementById('dataTable');
    if(toggle){ toggle.addEventListener('change', ()=>{ table.style.display = toggle.checked ? '' : 'none'; }); }
    const tabs = Array.from(document.querySelectorAll('[data-tab]'));
    function activate(name){ tabs.forEach(t=>t.classList.toggle('active', t.dataset.tab===name)); }
    tabs.forEach(t=> t.addEventListener('click', ()=> activate(t.dataset.tab)));
    if(tabs[0]) activate(tabs[0].dataset.tab);
  })();
</script>
